To run a command as administrator (user "root"), use "sudo <command>".
See "man sudo_root" for details.

aweisman@nci-02196596-vx:~$ 
aweisman@nci-02196596-vx:~$ 
aweisman@nci-02196596-vx:~$ 
aweisman@nci-02196596-vx:~$ 
aweisman@nci-02196596-vx:~$ ls .bashrc
.bashrc
aweisman@nci-02196596-vx:~$ ls .bash_profi^C
aweisman@nci-02196596-vx:~$ emac^C
aweisman@nci-02196596-vx:~$ sudo apt-install emacs^C
aweisman@nci-02196596-vx:~$ emac^C
aweisman@nci-02196596-vx:~$ sudo apt-instal^C
aweisman@nci-02196596-vx:~$ emacs .bashrc
	Fontconfig warning: "/etc/fonts/conf.avail/53-monospace-lcd-filter.conf", line 10: Having multiple values in <test> isn't supported and may not work as expected
aweisman@nci-02196596-vx:~$ 
aweisman@nci-02196596-vx:~$ 
aweisman@nci-02196596-vx:~$ ssh -Y weismanal@biowulf.nih.gov
                           ***WARNING***

You are accessing a U.S. Government information system, which includes
(1) this computer, (2) this computer network, (3) all computers 
connected to this network, and (4) all devices and storage media 
attached to this network or to a computer on this network. This 
information system is provided for U.S.  Government-authorized use only.

Unauthorized or improper use of this system may result in disciplinary
action, as well as civil and criminal penalties.

By using this information system, you understand and consent to the
following:

* You have no reasonable expectation of privacy regarding any 
communications or data transiting or stored on this information system. 
At any time, and for any lawful Government purpose, the government may 
monitor, intercept, record, and search and seize any communication or 
data transiting or stored on this information system.

* Any communication or data transiting or stored on this information 
system may be disclosed or used for any lawful Government purpose.

--
Notice to users:  This system is rebooted for patches and maintenance on
the first Monday of every month at 7:15AM unless Monday is a holiday, in
which case it is rebooted the following Tuesday.  Running cluster jobs
are not affected by the monthly reboot. 

weismanal@biowulf.nih.gov's password: 
Last login: Thu Apr  1 16:38:04 2021 from hg-02161038-lw0.nhgri.nih.gov
weismanal@biowulf:~ $ cd /home/weismanal/repos-local/ECP-CANDLE
weismanal@biowulf:~/repos-local/ECP-CANDLE $ git status
fatal: Not a git repository (or any parent up to mount point /gpfs/gsfs10)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
weismanal@biowulf:~/repos-local/ECP-CANDLE $ ls
Benchmarks
weismanal@biowulf:~/repos-local/ECP-CANDLE $ cd Benchmarks/
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ git status
# On branch cap-txfr
nothing to commit, working directory clean
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ git checkout develop
Switched to branch 'develop'
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ git pull
remote: Enumerating objects: 132, done.
remote: Counting objects: 100% (132/132), done.
remote: Compressing objects: 100% (64/64), done.
remote: Total 132 (delta 83), reused 109 (delta 65), pack-reused 0
Receiving objects: 100% (132/132), 63.90 KiB | 0 bytes/s, done.
Resolving deltas: 100% (83/83), completed with 35 local objects.
From github.com:ECP-CANDLE/Benchmarks
   7655104..aea5774  develop    -> origin/develop
 * [new branch]      utils_refactor -> origin/utils_refactor
Updating 7655104..aea5774
Checking out files: 100% (40/40), done.
Fast-forward
 .github/workflows/lint.yml             |   20 ++
 Pilot1/NT3/nt3.py                      |    3 +-
 Pilot1/NT3/nt3_baseline_keras2.py      |    2 +-
 Pilot1/NT3/nt3_default_model.txt       |    4 +-
 Pilot1/P1B3/README.md                  |    2 -
 Pilot1/P1B3/p1b3_baseline_keras2.py    |    2 +-
 Pilot1/Uno/uno_baseline_keras2.py      |   14 +-
 Pilot1/Uno/uno_baseline_tf2.py         |    1 -
 Pilot1/Uno/uno_clr_keras2.py           |   12 +-
 Pilot1/Uno/uno_contamination_keras2.py |   10 +-
 Pilot1/Uno/uno_data.py                 |    2 +-
 Pilot1/Uno/uno_holdoutUQ_data.py       |    4 +-
 Pilot1/Uno/uno_inferUQ_keras2.py       |    6 +-
 Pilot1/Uno/uno_trainUQ_keras2.py       |   12 +-
 Pilot3/P3B1/p3b1_baseline_keras2.py    |    6 +-
 Pilot3/P3B2/p3b2_baseline_keras2.py    |    8 +-
 Pilot3/P3B3/keras_mt_shared_cnn.py     |   12 +-
 Pilot3/P3B3/p3b3_baseline_keras2.py    |    2 +-
 Pilot3/P3B4/p3b4_baseline_keras2.py    |    2 +-
 Pilot3/P3B8/optimize.py                |    2 +-
 common/ckpt_keras_utils.py             |  170 +++++++++-----
 common/darts/api/config.py             |    2 +-
 common/default_utils.py                |    9 +-
 common/file_utils.py                   |    7 +-
 common/keras_utils.py                  |    1 +
 common/modac_utils.py                  |   47 ++--
 examples/image-vae/README.md           |   53 +++++
 examples/image-vae/ResNet.py           |  269 +++++++++++++++++++++
 examples/image-vae/dataloader.py       |   89 +++++++
 examples/image-vae/extra_uts.py        |  271 ++++++++++++++++++++++
 examples/image-vae/fetch.sh            |    3 +
 examples/image-vae/invert.py           |   44 ++++
 examples/image-vae/main.py             |  241 +++++++++++++++++++
 examples/image-vae/model.py            | 1184 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 examples/image-vae/models/.keep        |    0
 examples/image-vae/output/.keep        |    0
 examples/image-vae/sample.py           |   81 +++++++
 examples/image-vae/samples/.keep       |    0
 examples/image-vae/utils.py            |   94 ++++++++
 examples/rnngen/model/model.py         |   10 +-
 40 files changed, 2558 insertions(+), 143 deletions(-)
 create mode 100644 .github/workflows/lint.yml
 create mode 100644 examples/image-vae/README.md
 create mode 100644 examples/image-vae/ResNet.py
 create mode 100644 examples/image-vae/dataloader.py
 create mode 100644 examples/image-vae/extra_uts.py
 create mode 100755 examples/image-vae/fetch.sh
 create mode 100644 examples/image-vae/invert.py
 create mode 100644 examples/image-vae/main.py
 create mode 100644 examples/image-vae/model.py
 create mode 100644 examples/image-vae/models/.keep
 create mode 100644 examples/image-vae/output/.keep
 create mode 100644 examples/image-vae/sample.py
 create mode 100644 examples/image-vae/samples/.keep
 create mode 100644 examples/image-vae/utils.py
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ 
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ 
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ git checkout cap-txfr
Switched to branch 'cap-txfr'
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ git merge
fatal: No commit specified and merge.defaultToUpstream not set.
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ git merge develop
Updating 7655104..aea5774
Fast-forward
 .github/workflows/lint.yml             |   20 ++
 Pilot1/NT3/nt3.py                      |    3 +-
 Pilot1/NT3/nt3_baseline_keras2.py      |    2 +-
 Pilot1/NT3/nt3_default_model.txt       |    4 +-
 Pilot1/P1B3/README.md                  |    2 -
 Pilot1/P1B3/p1b3_baseline_keras2.py    |    2 +-
 Pilot1/Uno/uno_baseline_keras2.py      |   14 +-
 Pilot1/Uno/uno_baseline_tf2.py         |    1 -
 Pilot1/Uno/uno_clr_keras2.py           |   12 +-
 Pilot1/Uno/uno_contamination_keras2.py |   10 +-
 Pilot1/Uno/uno_data.py                 |    2 +-
 Pilot1/Uno/uno_holdoutUQ_data.py       |    4 +-
 Pilot1/Uno/uno_inferUQ_keras2.py       |    6 +-
 Pilot1/Uno/uno_trainUQ_keras2.py       |   12 +-
 Pilot3/P3B1/p3b1_baseline_keras2.py    |    6 +-
 Pilot3/P3B2/p3b2_baseline_keras2.py    |    8 +-
 Pilot3/P3B3/keras_mt_shared_cnn.py     |   12 +-
 Pilot3/P3B3/p3b3_baseline_keras2.py    |    2 +-
 Pilot3/P3B4/p3b4_baseline_keras2.py    |    2 +-
 Pilot3/P3B8/optimize.py                |    2 +-
 common/ckpt_keras_utils.py             |  170 +++++++++-----
 common/darts/api/config.py             |    2 +-
 common/default_utils.py                |    9 +-
 common/file_utils.py                   |    7 +-
 common/keras_utils.py                  |    1 +
 common/modac_utils.py                  |   47 ++--
 examples/image-vae/README.md           |   53 +++++
 examples/image-vae/ResNet.py           |  269 +++++++++++++++++++++
 examples/image-vae/dataloader.py       |   89 +++++++
 examples/image-vae/extra_uts.py        |  271 ++++++++++++++++++++++
 examples/image-vae/fetch.sh            |    3 +
 examples/image-vae/invert.py           |   44 ++++
 examples/image-vae/main.py             |  241 +++++++++++++++++++
 examples/image-vae/model.py            | 1184 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 examples/image-vae/models/.keep        |    0
 examples/image-vae/output/.keep        |    0
 examples/image-vae/sample.py           |   81 +++++++
 examples/image-vae/samples/.keep       |    0
 examples/image-vae/utils.py            |   94 ++++++++
 examples/rnngen/model/model.py         |   10 +-
 40 files changed, 2558 insertions(+), 143 deletions(-)
 create mode 100644 .github/workflows/lint.yml
 create mode 100644 examples/image-vae/README.md
 create mode 100644 examples/image-vae/ResNet.py
 create mode 100644 examples/image-vae/dataloader.py
 create mode 100644 examples/image-vae/extra_uts.py
 create mode 100755 examples/image-vae/fetch.sh
 create mode 100644 examples/image-vae/invert.py
 create mode 100644 examples/image-vae/main.py
 create mode 100644 examples/image-vae/model.py
 create mode 100644 examples/image-vae/models/.keep
 create mode 100644 examples/image-vae/output/.keep
 create mode 100644 examples/image-vae/sample.py
 create mode 100644 examples/image-vae/samples/.keep
 create mode 100644 examples/image-vae/utils.py
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ git diff develop
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ 
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ 
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ sinteractive --gres=gpu:k80:1 --mem=20G --no-gres-shell
salloc.exe: Pending job allocation 11956578
salloc.exe: job 11956578 queued and waiting for resources
salloc.exe: job 11956578 has been allocated resources
salloc.exe: Granted job allocation 11956578
salloc.exe: Waiting for resource configuration
salloc.exe: Nodes cn4229 are ready for job
[weismanal@cn4229 Benchmarks]$ 
[weismanal@cn4229 Benchmarks]$ 
[weismanal@cn4229 Benchmarks]$ . ~/.bash_profile
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks $ 
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks $ 
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks $ ls
common	examples  LICENSE  Pilot1  Pilot2  Pilot3  README.md  README.setup.linux  README.setup.mac
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks $ git status
# On branch cap-txfr
nothing to commit, working directory clean
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks $ ls co^C
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks $ cd common/
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/common $ ls
calibration_default.txt  clr_keras_utils.py	      exp_logger.py		  keras_utils.py      pytorch_utils.py
calibration_main.py	 darts			      feature_selection_utils.py  modac_utils.py      solr_keras.py
candle			 data_preprocessing_utils.py  file_utils.py		  noise_utils.py      uq_keras_utils.py
candle_keras		 data_utils.py		      generic_utils.py		  P1_utils.py	      uq_utils.py
ckpt_keras_utils.py	 default_utils.py	      helper_utils.py		  profiling_utils.py  viz_utils.py
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/common $ cd ..
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks $ ls
common	examples  LICENSE  Pilot1  Pilot2  Pilot3  README.md  README.setup.linux  README.setup.mac
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks $ cd Pilot2
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2 $ ls
P2B1  README_dataset.txt  README.md
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2 $ cd ..
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks $ ls
common	examples  LICENSE  Pilot1  Pilot2  Pilot3  README.md  README.setup.linux  README.setup.mac
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks $ ls *
LICENSE  README.md  README.setup.linux	README.setup.mac

common:
calibration_default.txt  clr_keras_utils.py	      exp_logger.py		  keras_utils.py      pytorch_utils.py
calibration_main.py	 darts			      feature_selection_utils.py  modac_utils.py      solr_keras.py
candle			 data_preprocessing_utils.py  file_utils.py		  noise_utils.py      uq_keras_utils.py
candle_keras		 data_utils.py		      generic_utils.py		  P1_utils.py	      uq_utils.py
ckpt_keras_utils.py	 default_utils.py	      helper_utils.py		  profiling_utils.py  viz_utils.py

examples:
ADRP  darts  histogen  image-vae  M16  mnist  rnagen  rnngen  unet

Pilot1:
Attn  Combo  NT3  P1B1	P1B2  P1B3  T29  TC1  Uno  UnoMT

Pilot2:
P2B1  README_dataset.txt  README.md

Pilot3:
P3B1  P3B2  P3B3  P3B4	P3B5  P3B6  P3B7  P3B8
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks $ cd examples/
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/examples $ cd image-vae/
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/examples/image-vae $ ls
dataloader.py  extra_uts.py  fetch.sh  invert.py  main.py  model.py  models  output  README.md	ResNet.py  sample.py  samples  utils.py
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/examples/image-vae $ less README.md 
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/examples/image-vae $ 
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/examples/image-vae $ 
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/examples/image-vae $ cd ..
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/examples $ cd ..
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks $ cd Pilot2/P2B1
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ which python
/usr/local/bin/python
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ python
Python 2.7.15 | packaged by conda-forge | (default, Mar  5 2020, 14:56:06) 
[GCC 7.3.0] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> 
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ module load python
[+] Loading python 3.7  ... 
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ python
Python 3.7.5 (default, Oct 25 2019, 15:51:11) 
[GCC 7.3.0] :: Anaconda, Inc. on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> 
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ which python
/usr/local/Anaconda/envs/py3.7/bin/python
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ 
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ 
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ python p2b1_baseline_keras2.py 
Importing candle utils for keras
Params:
{'activation': 'relu',
 'backend': 'tensorflow',
 'base_memo': 'p2b1',
 'batch_size': 64,
 'case': 'Full',
 'conv_bool': True,
 'cool': False,
 'data_set': '3k_Ordered',
 'data_type': <class 'numpy.float32'>,
 'dropout': 0.5,
 'epochs': 2,
 'eval_bool': False,
 'experiment_id': 'EXP000',
 'fig_bool': False,
 'full_conv_bool': False,
 'home_dir': '.',
 'l2_reg': 0.01,
 'learning_rate': 0.01,
 'logfile': None,
 'loss': 'custom',
 'molecular_nbrs': 200,
 'molecular_nonlinearity': 'elu',
 'molecular_num_hidden': [256, 128, 64, 32, 16, 8],
 'nbr_type': 'relative',
 'noise_factor': 0.0,
 'num_hidden': [512, 32],
 'optimizer': 'adam',
 'output_dir': '/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/Pilot2/P2B1/Output/EXP000/RUN000',
 'profiling': False,
 'rng_seed': 7102,
 'run_id': 'RUN000',
 'sampling_density': 0.15,
 'save_path': '.',
 'set_sel': '3k_Disordered',
 'shuffle': False,
 'timeout': -1,
 'train_bool': True,
 'type_bool': True,
 'verbose': None,
 'weight_path': None}

Training parameters:
	activation: relu
	backend: tensorflow
	base_memo: p2b1
	batch_size: 64
	case: Full
	conv_bool: True
	cool: False
	data_set: 3k_Ordered
	data_type: <class 'numpy.float32'>
	dropout: 0.5
	epochs: 2
	eval_bool: False
	experiment_id: EXP000
	fig_bool: False
	full_conv_bool: False
	home_dir: .
	l2_reg: 0.01
	learning_rate: 0.01
	logfile: None
	loss: custom
	molecular_nbrs: 200
	molecular_nonlinearity: elu
	molecular_num_hidden: [256, 128, 64, 32, 16, 8]
	nbr_type: relative
	noise_factor: 0.0
	num_hidden: [512, 32]
	optimizer: adam
	output_dir: /gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/Pilot2/P2B1/Output/EXP000/RUN000
	profiling: False
	rng_seed: 7102
	run_id: RUN000
	sampling_density: 0.15
	save_path: .
	set_sel: 3k_Disordered
	shuffle: False
	timeout: -1
	train_bool: True
	type_bool: True
	verbose: None
	weight_path: None
Image data format:  channels_last
Params: {'num_hidden': [512, 32], 'batch_size': 64, 'learning_rate': 0.01, 'epochs': 2, 'cool': False, 'l2_reg': 0.01, 'noise_factor': 0.0, 'optimizer': 'adam', 'loss': 'custom', 'activation': 'relu', 'molecular_nonlinearity': 'elu', 'molecular_num_hidden': [256, 128, 64, 32, 16, 8], 'molecular_nbrs': 200, 'base_memo': 'p2b1', 'dropout': 0.5, 'data_set': '3k_Ordered', 'sampling_density': 0.15, 'save_path': '.', 'backend': 'tensorflow', 'verbose': None, 'logfile': None, 'experiment_id': 'EXP000', 'run_id': 'RUN000', 'shuffle': False, 'profiling': False, 'train_bool': True, 'eval_bool': False, 'home_dir': '.', 'weight_path': None, 'case': 'Full', 'fig_bool': False, 'set_sel': '3k_Disordered', 'conv_bool': True, 'full_conv_bool': False, 'type_bool': True, 'nbr_type': 'relative', 'data_type': <class 'numpy.float32'>, 'output_dir': '/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/Pilot2/P2B1/Output/EXP000/RUN000', 'rng_seed': 7102, 'timeout': -1}
Reading Data...
Reading Data Files... 3k_Disordered->3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir
Downloading data from http://ftp.mcs.anl.gov/pub/candle/public/benchmarks/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir.tar.gz
3088539648/3088534718 [==============================] - 30s       

Untarring file...

Data chunk shape:  (100, 3040, 12, 20)

State AE input/output dimension:  24320

Molecular AE input/output dimension:  48240

Data Format:
[Frames (2900), Molecules (3040), Beads (12), ['rel_x', 'rel_y', 'rel_z', 'CHOL', 'DPPC', 'DIPC', 'Head', 'Tail', 'BL1', 'BL2', 'BL3', 'BL4', 'BL5', 'BL6', 'BL7', 'BL8', 'BL9', 'BL10', 'BL11', 'BL12'] (20)]

Define the model and compile

Model Summary: 

Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 1, 48240, 1)]     0         
_________________________________________________________________
conv2d (Conv2D)              (None, 1, 2412, 256)      102400    
_________________________________________________________________
batch_normalization (BatchNo (None, 1, 2412, 256)      1024      
_________________________________________________________________
dropout (Dropout)            (None, 1, 2412, 256)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 1, 201, 128)       4718592   
_________________________________________________________________
batch_normalization_1 (Batch (None, 1, 201, 128)       512       
_________________________________________________________________
dropout_1 (Dropout)          (None, 1, 201, 128)       0         
_________________________________________________________________
flatten (Flatten)            (None, 25728)             0         
_________________________________________________________________
dense (Dense)                (None, 64)                1646592   
_________________________________________________________________
batch_normalization_2 (Batch (None, 64)                256       
_________________________________________________________________
dropout_2 (Dropout)          (None, 64)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 32)                2048      
_________________________________________________________________
batch_normalization_3 (Batch (None, 32)                128       
_________________________________________________________________
dropout_3 (Dropout)          (None, 32)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 16)                512       
_________________________________________________________________
batch_normalization_4 (Batch (None, 16)                64        
_________________________________________________________________
dropout_4 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_3 (Dense)              (None, 8)                 128       
_________________________________________________________________
batch_normalization_5 (Batch (None, 8)                 32        
_________________________________________________________________
dense_4 (Dense)              (None, 16)                128       
_________________________________________________________________
batch_normalization_6 (Batch (None, 16)                64        
_________________________________________________________________
dropout_5 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_5 (Dense)              (None, 32)                512       
_________________________________________________________________
batch_normalization_7 (Batch (None, 32)                128       
_________________________________________________________________
dropout_6 (Dropout)          (None, 32)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 64)                2048      
_________________________________________________________________
batch_normalization_8 (Batch (None, 64)                256       
_________________________________________________________________
dropout_7 (Dropout)          (None, 64)                0         
_________________________________________________________________
dense_7 (Dense)              (None, 128)               8192      
_________________________________________________________________
batch_normalization_9 (Batch (None, 128)               512       
_________________________________________________________________
dropout_8 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_8 (Dense)              (None, 256)               32768     
_________________________________________________________________
batch_normalization_10 (Batc (None, 256)               1024      
_________________________________________________________________
dropout_9 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 48240)             12349440  
=================================================================
Total params: 18,867,360
Trainable params: 18,865,360
Non-trainable params: 2,000
_________________________________________________________________
Saved model to disk

Training epoch: 1

/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/common/../Data/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_10_outof_29.npz 

Datagen on the following frames [80, 42, 74, 28, 67, 19, 11, 83, 35, 9, 17, 93, 54, 84, 63]
Killed
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ ls
encoder.json  helper.py   model.json  p2b1_AE_models.py        p2b1_default_model.txt  p2b1.py		     parameter_set.R	 __pycache__
epoch_1       INSTALL.md  Output      p2b1_baseline_keras2.py  p2b1_medium_model.txt   p2b1_small_model.txt  pilot2_datasets.py  README.md
weismanal@cn4229:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ cd ~/DATA/
weismanal@cn4229:~/DATA $ ls
apps  bin  datashare  miniconda3  notebook  R  repos  transfer
weismanal@cn4229:~/DATA $ cd repos/
weismanal@cn4229:~/DATA/repos $ ls
archive  ATOMconsortium  BARE  candle_tutorials  ECP-CANDLE  Lmod  machine_learning  repo  segmentation_models	shellcheck
weismanal@cn4229:~/DATA/repos $ cd ECP-CANDLE/
weismanal@cn4229:~/DATA/repos/ECP-CANDLE $ cd Benchmarks/
weismanal@cn4229:~/DATA/repos/ECP-CANDLE/Benchmarks $ ls
common	Data  examples	LICENSE  Pilot1  Pilot2  Pilot3  README.md  README.setup.linux	README.setup.mac
weismanal@cn4229:~/DATA/repos/ECP-CANDLE/Benchmarks $ git status
# On branch cap-txfr
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#	Pilot2/P2B1/..log
#	Pilot2/P2B1/encoder.json
#	Pilot2/P2B1/model.json
nothing added to commit but untracked files present (use "git add" to track)
weismanal@cn4229:~/DATA/repos/ECP-CANDLE/Benchmarks $ cd -
/home/weismanal/DATA/repos/ECP-CANDLE
weismanal@cn4229:~/DATA/repos/ECP-CANDLE $ cd cd /home/weismanal/repos-local/ECP-CANDLE
bash: cd: cd: No such file or directory
weismanal@cn4229:~/DATA/repos/ECP-CANDLE $ cd cd /home/weismanal/repos-local/ECP-CANDLE^C
weismanal@cn4229:~/DATA/repos/ECP-CANDLE $ cd /home/weismanal/repos-local/ECP-CANDLE
weismanal@cn4229:~/repos-local/ECP-CANDLE $ readlink -f .
/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE
weismanal@cn4229:~/repos-local/ECP-CANDLE $ cd /data/weismanal
weismanal@cn4229:/data/weismanal $ readlink -f .
/gpfs/gsfs10/users/weismanal
weismanal@cn4229:/data/weismanal $ cd
weismanal@cn4229:~ $ ll
total 8
lrwxrwxrwx 1 weismanal weismanal   14 Nov 26  2019 BIDS-HPC -> /data/BIDS-HPC
lrwxrwxrwx 1 weismanal weismanal    8 Dec 18 14:40 bin -> DATA/bin
lrwxrwxrwx 1 weismanal weismanal   15 Dec 18 14:38 DATA -> /data/weismanal
lrwxrwxrwx 1 weismanal weismanal   14 Dec 18 14:42 datashare -> DATA/datashare
lrwxrwxrwx 1 weismanal weismanal   13 Dec 18 14:43 notebook -> DATA/notebook
lrwxrwxrwx 1 weismanal weismanal    6 Dec 18 14:45 R -> DATA/R
lrwxrwxrwx 1 weismanal weismanal   34 Nov 26  2019 repos-BIDS-HPC -> BIDS-HPC/public/software/checkouts
lrwxrwxrwx 1 weismanal weismanal   10 Dec 18 15:01 repos-local -> DATA/repos
lrwxrwxrwx 1 weismanal weismanal   18 Dec 18 14:38 SCRATCH -> /scratch/weismanal
drwxrwxr-x 2 weismanal weismanal 4096 Dec 28 15:36 seaborn-data
lrwxrwxrwx 1 weismanal weismanal   13 Dec 18 14:45 transfer -> DATA/transfer
drwxrwxr-x 2 weismanal weismanal 4096 Feb 23 12:12 Wolfram Mathematica
weismanal@cn4229:~ $ exit
exit
salloc.exe: Relinquishing job allocation 11956578
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ sinteractive --gres=gpu:k80:1 --mem=60G --no-gres-shell
salloc.exe: Pending job allocation 11957840
salloc.exe: job 11957840 queued and waiting for resources
salloc.exe: job 11957840 has been allocated resources
salloc.exe: Granted job allocation 11957840
salloc.exe: Waiting for resource configuration
salloc.exe: Nodes cn4202 are ready for job
[weismanal@cn4202 Benchmarks]$ . ~/.bash_profile
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks $ cd /home/weismanal/repos-local/ECP-CANDLE
weismanal@cn4202:~/repos-local/ECP-CANDLE $ cd Benchmarks/
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks $ git status
# On branch cap-txfr
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#	Pilot2/P2B1/..log
#	Pilot2/P2B1/encoder.json
#	Pilot2/P2B1/model.json
nothing added to commit but untracked files present (use "git add" to track)
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks $ cd Pilot2/P2B1/
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ ll -h *
-rw-rw-r--  1 weismanal weismanal 9.0K Apr  2 11:44 encoder.json
-rw-rw-r--. 1 weismanal weismanal 7.8K Mar 26 17:38 helper.py
-rw-rw-r--. 1 weismanal weismanal 1.2K Mar 26 17:07 INSTALL.md
-rw-rw-r--  1 weismanal weismanal  17K Apr  2 11:44 model.json
-rw-rw-r--. 1 weismanal weismanal  12K Mar 26 17:38 p2b1_AE_models.py
-rw-rw-r--. 1 weismanal weismanal  12K Mar 26 17:38 p2b1_baseline_keras2.py
-rw-rw-r--. 1 weismanal weismanal  378 Mar 26 17:07 p2b1_default_model.txt
-rw-rw-r--. 1 weismanal weismanal  351 Mar 26 17:07 p2b1_medium_model.txt
-rw-rw-r--. 1 weismanal weismanal  16K Mar 26 17:38 p2b1.py
-rw-rw-r--. 1 weismanal weismanal  325 Mar 26 17:07 p2b1_small_model.txt
-rw-rw-r--. 1 weismanal weismanal 1.4K Mar 26 17:07 parameter_set.R
-rw-rw-r--. 1 weismanal weismanal 1.1K Mar 26 17:38 pilot2_datasets.py
-rw-rw-r--. 1 weismanal weismanal 9.4K Mar 26 17:07 README.md

epoch_1:
total 0

Output:
total 1.0K
drwxrwxr-x 3 weismanal weismanal 4.0K Apr  2 11:41 EXP000

__pycache__:
total 385K
-rw-rw-r-- 1 weismanal weismanal 7.2K Apr  2 11:41 helper.cpython-37.pyc
-rw-rw-r-- 1 weismanal weismanal 5.0K Apr  2 11:41 p2b1_AE_models.cpython-37.pyc
-rw-rw-r-- 1 weismanal weismanal  11K Apr  2 11:41 p2b1.cpython-37.pyc
-rw-rw-r-- 1 weismanal weismanal 1.4K Apr  2 11:41 pilot2_datasets.cpython-37.pyc
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ ll -h
total 902K
-rw-rw-r--  1 weismanal weismanal 9.0K Apr  2 11:44 encoder.json
drwxrwxr-x  2 weismanal weismanal 4.0K Apr  2 11:44 epoch_1
-rw-rw-r--. 1 weismanal weismanal 7.8K Mar 26 17:38 helper.py
-rw-rw-r--. 1 weismanal weismanal 1.2K Mar 26 17:07 INSTALL.md
-rw-rw-r--  1 weismanal weismanal  17K Apr  2 11:44 model.json
drwxrwxr-x  3 weismanal weismanal 4.0K Apr  2 11:41 Output
-rw-rw-r--. 1 weismanal weismanal  12K Mar 26 17:38 p2b1_AE_models.py
-rw-rw-r--. 1 weismanal weismanal  12K Mar 26 17:38 p2b1_baseline_keras2.py
-rw-rw-r--. 1 weismanal weismanal  378 Mar 26 17:07 p2b1_default_model.txt
-rw-rw-r--. 1 weismanal weismanal  351 Mar 26 17:07 p2b1_medium_model.txt
-rw-rw-r--. 1 weismanal weismanal  16K Mar 26 17:38 p2b1.py
-rw-rw-r--. 1 weismanal weismanal  325 Mar 26 17:07 p2b1_small_model.txt
-rw-rw-r--. 1 weismanal weismanal 1.4K Mar 26 17:07 parameter_set.R
-rw-rw-r--. 1 weismanal weismanal 1.1K Mar 26 17:38 pilot2_datasets.py
drwxrwxr-x  2 weismanal weismanal 4.0K Apr  2 11:41 __pycache__
-rw-rw-r--. 1 weismanal weismanal 9.4K Mar 26 17:07 README.md
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ ll -ha
total 905K
drwxrwxr-x. 5 weismanal weismanal 4.0K Apr  2 11:44 .
drwxrwxr-x. 3 weismanal weismanal 4.0K Mar 26 17:07 ..
-rw-rw-r--  1 weismanal weismanal 9.0K Apr  2 11:44 encoder.json
drwxrwxr-x  2 weismanal weismanal 4.0K Apr  2 11:44 epoch_1
-rw-rw-r--. 1 weismanal weismanal 7.8K Mar 26 17:38 helper.py
-rw-rw-r--. 1 weismanal weismanal 1.2K Mar 26 17:07 INSTALL.md
-rw-rw-r--  1 weismanal weismanal  993 Apr  2 11:41 ..log
-rw-rw-r--  1 weismanal weismanal  17K Apr  2 11:44 model.json
drwxrwxr-x  3 weismanal weismanal 4.0K Apr  2 11:41 Output
-rw-rw-r--. 1 weismanal weismanal  12K Mar 26 17:38 p2b1_AE_models.py
-rw-rw-r--. 1 weismanal weismanal  12K Mar 26 17:38 p2b1_baseline_keras2.py
-rw-rw-r--. 1 weismanal weismanal  378 Mar 26 17:07 p2b1_default_model.txt
-rw-rw-r--. 1 weismanal weismanal  351 Mar 26 17:07 p2b1_medium_model.txt
-rw-rw-r--. 1 weismanal weismanal  16K Mar 26 17:38 p2b1.py
-rw-rw-r--. 1 weismanal weismanal  325 Mar 26 17:07 p2b1_small_model.txt
-rw-rw-r--. 1 weismanal weismanal 1.4K Mar 26 17:07 parameter_set.R
-rw-rw-r--. 1 weismanal weismanal 1.1K Mar 26 17:38 pilot2_datasets.py
drwxrwxr-x  2 weismanal weismanal 4.0K Apr  2 11:41 __pycache__
-rw-rw-r--. 1 weismanal weismanal 9.4K Mar 26 17:07 README.md
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ git status
# On branch cap-txfr
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#	..log
#	encoder.json
#	model.json
nothing added to commit but untracked files present (use "git add" to track)
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ rm .log encoder.json model.json 
rm: cannot remove ‘.log’: No such file or directory
rm: remove regular file ‘encoder.json’? ^C
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ rm ..log encoder.json model.json 
rm: remove regular file ‘..log’? y
rm: remove regular file ‘encoder.json’? y
rm: remove regular file ‘model.json’? y
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ git status
# On branch cap-txfr
nothing to commit, working directory clean
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ module load python
[+] Loading python 3.7  ... 
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ ls p2b1_baseline_keras2.py 
p2b1_baseline_keras2.py
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ 
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ 
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ ls
epoch_1    INSTALL.md  p2b1_AE_models.py	p2b1_default_model.txt	p2b1.py		      parameter_set.R	  __pycache__
helper.py  Output      p2b1_baseline_keras2.py	p2b1_medium_model.txt	p2b1_small_model.txt  pilot2_datasets.py  README.md
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ git status
# On branch cap-txfr
nothing to commit, working directory clean
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ which python
/usr/local/Anaconda/envs/py3.7/bin/python
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ 
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ 
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ python p2b1_baseline_keras2.py
Importing candle utils for keras
Params:
{'activation': 'relu',
 'backend': 'tensorflow',
 'base_memo': 'p2b1',
 'batch_size': 64,
 'case': 'Full',
 'conv_bool': True,
 'cool': False,
 'data_set': '3k_Ordered',
 'data_type': <class 'numpy.float32'>,
 'dropout': 0.5,
 'epochs': 2,
 'eval_bool': False,
 'experiment_id': 'EXP000',
 'fig_bool': False,
 'full_conv_bool': False,
 'home_dir': '.',
 'l2_reg': 0.01,
 'learning_rate': 0.01,
 'logfile': None,
 'loss': 'custom',
 'molecular_nbrs': 200,
 'molecular_nonlinearity': 'elu',
 'molecular_num_hidden': [256, 128, 64, 32, 16, 8],
 'nbr_type': 'relative',
 'noise_factor': 0.0,
 'num_hidden': [512, 32],
 'optimizer': 'adam',
 'output_dir': '/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/Pilot2/P2B1/Output/EXP000/RUN000',
 'profiling': False,
 'rng_seed': 7102,
 'run_id': 'RUN000',
 'sampling_density': 0.15,
 'save_path': '.',
 'set_sel': '3k_Disordered',
 'shuffle': False,
 'timeout': -1,
 'train_bool': True,
 'type_bool': True,
 'verbose': None,
 'weight_path': None}

Training parameters:
	activation: relu
	backend: tensorflow
	base_memo: p2b1
	batch_size: 64
	case: Full
	conv_bool: True
	cool: False
	data_set: 3k_Ordered
	data_type: <class 'numpy.float32'>
	dropout: 0.5
	epochs: 2
	eval_bool: False
	experiment_id: EXP000
	fig_bool: False
	full_conv_bool: False
	home_dir: .
	l2_reg: 0.01
	learning_rate: 0.01
	logfile: None
	loss: custom
	molecular_nbrs: 200
	molecular_nonlinearity: elu
	molecular_num_hidden: [256, 128, 64, 32, 16, 8]
	nbr_type: relative
	noise_factor: 0.0
	num_hidden: [512, 32]
	optimizer: adam
	output_dir: /gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/Pilot2/P2B1/Output/EXP000/RUN000
	profiling: False
	rng_seed: 7102
	run_id: RUN000
	sampling_density: 0.15
	save_path: .
	set_sel: 3k_Disordered
	shuffle: False
	timeout: -1
	train_bool: True
	type_bool: True
	verbose: None
	weight_path: None
Image data format:  channels_last
Params: {'num_hidden': [512, 32], 'batch_size': 64, 'learning_rate': 0.01, 'epochs': 2, 'cool': False, 'l2_reg': 0.01, 'noise_factor': 0.0, 'optimizer': 'adam', 'loss': 'custom', 'activation': 'relu', 'molecular_nonlinearity': 'elu', 'molecular_num_hidden': [256, 128, 64, 32, 16, 8], 'molecular_nbrs': 200, 'base_memo': 'p2b1', 'dropout': 0.5, 'data_set': '3k_Ordered', 'sampling_density': 0.15, 'save_path': '.', 'backend': 'tensorflow', 'verbose': None, 'logfile': None, 'experiment_id': 'EXP000', 'run_id': 'RUN000', 'shuffle': False, 'profiling': False, 'train_bool': True, 'eval_bool': False, 'home_dir': '.', 'weight_path': None, 'case': 'Full', 'fig_bool': False, 'set_sel': '3k_Disordered', 'conv_bool': True, 'full_conv_bool': False, 'type_bool': True, 'nbr_type': 'relative', 'data_type': <class 'numpy.float32'>, 'output_dir': '/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/Pilot2/P2B1/Output/EXP000/RUN000', 'rng_seed': 7102, 'timeout': -1}
Reading Data...
Reading Data Files... 3k_Disordered->3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir

Data chunk shape:  (100, 3040, 12, 20)

State AE input/output dimension:  24320

Molecular AE input/output dimension:  48240

Data Format:
[Frames (2900), Molecules (3040), Beads (12), ['rel_x', 'rel_y', 'rel_z', 'CHOL', 'DPPC', 'DIPC', 'Head', 'Tail', 'BL1', 'BL2', 'BL3', 'BL4', 'BL5', 'BL6', 'BL7', 'BL8', 'BL9', 'BL10', 'BL11', 'BL12'] (20)]

Define the model and compile

Model Summary: 

Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 1, 48240, 1)]     0         
_________________________________________________________________
conv2d (Conv2D)              (None, 1, 2412, 256)      102400    
_________________________________________________________________
batch_normalization (BatchNo (None, 1, 2412, 256)      1024      
_________________________________________________________________
dropout (Dropout)            (None, 1, 2412, 256)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 1, 201, 128)       4718592   
_________________________________________________________________
batch_normalization_1 (Batch (None, 1, 201, 128)       512       
_________________________________________________________________
dropout_1 (Dropout)          (None, 1, 201, 128)       0         
_________________________________________________________________
flatten (Flatten)            (None, 25728)             0         
_________________________________________________________________
dense (Dense)                (None, 64)                1646592   
_________________________________________________________________
batch_normalization_2 (Batch (None, 64)                256       
_________________________________________________________________
dropout_2 (Dropout)          (None, 64)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 32)                2048      
_________________________________________________________________
batch_normalization_3 (Batch (None, 32)                128       
_________________________________________________________________
dropout_3 (Dropout)          (None, 32)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 16)                512       
_________________________________________________________________
batch_normalization_4 (Batch (None, 16)                64        
_________________________________________________________________
dropout_4 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_3 (Dense)              (None, 8)                 128       
_________________________________________________________________
batch_normalization_5 (Batch (None, 8)                 32        
_________________________________________________________________
dense_4 (Dense)              (None, 16)                128       
_________________________________________________________________
batch_normalization_6 (Batch (None, 16)                64        
_________________________________________________________________
dropout_5 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_5 (Dense)              (None, 32)                512       
_________________________________________________________________
batch_normalization_7 (Batch (None, 32)                128       
_________________________________________________________________
dropout_6 (Dropout)          (None, 32)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 64)                2048      
_________________________________________________________________
batch_normalization_8 (Batch (None, 64)                256       
_________________________________________________________________
dropout_7 (Dropout)          (None, 64)                0         
_________________________________________________________________
dense_7 (Dense)              (None, 128)               8192      
_________________________________________________________________
batch_normalization_9 (Batch (None, 128)               512       
_________________________________________________________________
dropout_8 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_8 (Dense)              (None, 256)               32768     
_________________________________________________________________
batch_normalization_10 (Batc (None, 256)               1024      
_________________________________________________________________
dropout_9 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 48240)             12349440  
=================================================================
Total params: 18,867,360
Trainable params: 18,865,360
Non-trainable params: 2,000
_________________________________________________________________
Saved model to disk

Training epoch: 1

/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/common/../Data/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_05_outof_29.npz 

Datagen on the following frames [69, 41, 5, 28, 17, 97, 80, 32, 85, 60, 87, 42, 56, 91, 16]
17/48 [=========>....................] - ETA: 7:09 - loss: 4.3161 - mean_squared_error: 0.0358 - mean_absolute_error: 0.0916^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^CTraceback (most recent call last):
  File "p2b1_baseline_keras2.py", line 307, in <module>
    main()
  File "p2b1_baseline_keras2.py", line 303, in main
    run(gParameters)
  File "p2b1_baseline_keras2.py", line 292, in run
    frame_loss, frame_mse = ct.train_ac()
  File "/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/Pilot2/P2B1/p2b1.py", line 344, in train_ac
    batch_size=self.batch_size, callbacks=self.callbacks[:2])
  File "/usr/local/Anaconda/envs/py3.7/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 66, in _method_wrapper
    return method(self, *args, **kwargs)
  File "/usr/local/Anaconda/envs/py3.7/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 848, in fit
    tmp_logs = train_function(iterator)
  File "/usr/local/Anaconda/envs/py3.7/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/usr/local/Anaconda/envs/py3.7/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 611, in _call
    return self._stateless_fn(*args, **kwds)  # pylint: disable=not-callable
  File "/usr/local/Anaconda/envs/py3.7/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 2420, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/usr/local/Anaconda/envs/py3.7/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 1665, in _filtered_call
    self.captured_inputs)
  File "/usr/local/Anaconda/envs/py3.7/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 1746, in _call_flat
    ctx, args, cancellation_manager=cancellation_manager))
  File "/usr/local/Anaconda/envs/py3.7/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 598, in call
    ctx=ctx)
  File "/usr/local/Anaconda/envs/py3.7/lib/python3.7/site-packages/tensorflow/python/eager/execute.py", line 60, in quick_execute
    inputs, attrs, num_outputs)
KeyboardInterrupt
^C^C^C^C^C^C
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ ^C
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ ^C
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ ^C
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ ^C
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ ^C
weismanal@cn4202:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ exit
exit
srun: error: cn4202: task 0: Exited with exit code 130
salloc.exe: Relinquishing job allocation 11957840
salloc.exe: Job allocation 11957840 has been revoked.
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ 
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ 
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ 
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ sinteractive --gres=gpu:k80:1 --mem=60G
salloc.exe: Pending job allocation 11959219
salloc.exe: job 11959219 queued and waiting for resources
salloc.exe: job 11959219 has been allocated resources
salloc.exe: Granted job allocation 11959219
salloc.exe: Waiting for resource configuration
salloc.exe: Nodes cn4186 are ready for job
[weismanal@cn4186 Benchmarks]$ . ~/.bash_profile
weismanal@cn4186:~/repos-local/ECP-CANDLE/Benchmarks $ git status
# On branch cap-txfr
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#	Pilot2/P2B1/..log
#	Pilot2/P2B1/encoder.json
#	Pilot2/P2B1/model.json
nothing added to commit but untracked files present (use "git add" to track)
weismanal@cn4186:~/repos-local/ECP-CANDLE/Benchmarks $ rm ..log encoder.json model.json
rm: cannot remove ‘..log’: No such file or directory
rm: cannot remove ‘encoder.json’: No such file or directory
rm: cannot remove ‘model.json’: No such file or directory
weismanal@cn4186:~/repos-local/ECP-CANDLE/Benchmarks $ cd Pilot2/P2B1/
weismanal@cn4186:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ rm ..log encoder.json model.json
rm: remove regular file ‘..log’? y
rm: remove regular file ‘encoder.json’? y
rm: remove regular file ‘model.json’? y
weismanal@cn4186:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ module load python
[+] Loading python 3.7  ... 
weismanal@cn4186:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ python p2b1_baseline_keras2.py
Importing candle utils for keras
Params:
{'activation': 'relu',
 'backend': 'tensorflow',
 'base_memo': 'p2b1',
 'batch_size': 64,
 'case': 'Full',
 'conv_bool': True,
 'cool': False,
 'data_set': '3k_Ordered',
 'data_type': <class 'numpy.float32'>,
 'dropout': 0.5,
 'epochs': 2,
 'eval_bool': False,
 'experiment_id': 'EXP000',
 'fig_bool': False,
 'full_conv_bool': False,
 'home_dir': '.',
 'l2_reg': 0.01,
 'learning_rate': 0.01,
 'logfile': None,
 'loss': 'custom',
 'molecular_nbrs': 200,
 'molecular_nonlinearity': 'elu',
 'molecular_num_hidden': [256, 128, 64, 32, 16, 8],
 'nbr_type': 'relative',
 'noise_factor': 0.0,
 'num_hidden': [512, 32],
 'optimizer': 'adam',
 'output_dir': '/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/Pilot2/P2B1/Output/EXP000/RUN000',
 'profiling': False,
 'rng_seed': 7102,
 'run_id': 'RUN000',
 'sampling_density': 0.15,
 'save_path': '.',
 'set_sel': '3k_Disordered',
 'shuffle': False,
 'timeout': -1,
 'train_bool': True,
 'type_bool': True,
 'verbose': None,
 'weight_path': None}

Training parameters:
	activation: relu
	backend: tensorflow
	base_memo: p2b1
	batch_size: 64
	case: Full
	conv_bool: True
	cool: False
	data_set: 3k_Ordered
	data_type: <class 'numpy.float32'>
	dropout: 0.5
	epochs: 2
	eval_bool: False
	experiment_id: EXP000
	fig_bool: False
	full_conv_bool: False
	home_dir: .
	l2_reg: 0.01
	learning_rate: 0.01
	logfile: None
	loss: custom
	molecular_nbrs: 200
	molecular_nonlinearity: elu
	molecular_num_hidden: [256, 128, 64, 32, 16, 8]
	nbr_type: relative
	noise_factor: 0.0
	num_hidden: [512, 32]
	optimizer: adam
	output_dir: /gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/Pilot2/P2B1/Output/EXP000/RUN000
	profiling: False
	rng_seed: 7102
	run_id: RUN000
	sampling_density: 0.15
	save_path: .
	set_sel: 3k_Disordered
	shuffle: False
	timeout: -1
	train_bool: True
	type_bool: True
	verbose: None
	weight_path: None
Image data format:  channels_last
Params: {'num_hidden': [512, 32], 'batch_size': 64, 'learning_rate': 0.01, 'epochs': 2, 'cool': False, 'l2_reg': 0.01, 'noise_factor': 0.0, 'optimizer': 'adam', 'loss': 'custom', 'activation': 'relu', 'molecular_nonlinearity': 'elu', 'molecular_num_hidden': [256, 128, 64, 32, 16, 8], 'molecular_nbrs': 200, 'base_memo': 'p2b1', 'dropout': 0.5, 'data_set': '3k_Ordered', 'sampling_density': 0.15, 'save_path': '.', 'backend': 'tensorflow', 'verbose': None, 'logfile': None, 'experiment_id': 'EXP000', 'run_id': 'RUN000', 'shuffle': False, 'profiling': False, 'train_bool': True, 'eval_bool': False, 'home_dir': '.', 'weight_path': None, 'case': 'Full', 'fig_bool': False, 'set_sel': '3k_Disordered', 'conv_bool': True, 'full_conv_bool': False, 'type_bool': True, 'nbr_type': 'relative', 'data_type': <class 'numpy.float32'>, 'output_dir': '/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/Pilot2/P2B1/Output/EXP000/RUN000', 'rng_seed': 7102, 'timeout': -1}
Reading Data...
Reading Data Files... 3k_Disordered->3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir

Data chunk shape:  (100, 3040, 12, 20)

State AE input/output dimension:  24320

Molecular AE input/output dimension:  48240

Data Format:
[Frames (2900), Molecules (3040), Beads (12), ['rel_x', 'rel_y', 'rel_z', 'CHOL', 'DPPC', 'DIPC', 'Head', 'Tail', 'BL1', 'BL2', 'BL3', 'BL4', 'BL5', 'BL6', 'BL7', 'BL8', 'BL9', 'BL10', 'BL11', 'BL12'] (20)]

Define the model and compile

Model Summary: 

Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 1, 48240, 1)]     0         
_________________________________________________________________
conv2d (Conv2D)              (None, 1, 2412, 256)      102400    
_________________________________________________________________
batch_normalization (BatchNo (None, 1, 2412, 256)      1024      
_________________________________________________________________
dropout (Dropout)            (None, 1, 2412, 256)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 1, 201, 128)       4718592   
_________________________________________________________________
batch_normalization_1 (Batch (None, 1, 201, 128)       512       
_________________________________________________________________
dropout_1 (Dropout)          (None, 1, 201, 128)       0         
_________________________________________________________________
flatten (Flatten)            (None, 25728)             0         
_________________________________________________________________
dense (Dense)                (None, 64)                1646592   
_________________________________________________________________
batch_normalization_2 (Batch (None, 64)                256       
_________________________________________________________________
dropout_2 (Dropout)          (None, 64)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 32)                2048      
_________________________________________________________________
batch_normalization_3 (Batch (None, 32)                128       
_________________________________________________________________
dropout_3 (Dropout)          (None, 32)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 16)                512       
_________________________________________________________________
batch_normalization_4 (Batch (None, 16)                64        
_________________________________________________________________
dropout_4 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_3 (Dense)              (None, 8)                 128       
_________________________________________________________________
batch_normalization_5 (Batch (None, 8)                 32        
_________________________________________________________________
dense_4 (Dense)              (None, 16)                128       
_________________________________________________________________
batch_normalization_6 (Batch (None, 16)                64        
_________________________________________________________________
dropout_5 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_5 (Dense)              (None, 32)                512       
_________________________________________________________________
batch_normalization_7 (Batch (None, 32)                128       
_________________________________________________________________
dropout_6 (Dropout)          (None, 32)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 64)                2048      
_________________________________________________________________
batch_normalization_8 (Batch (None, 64)                256       
_________________________________________________________________
dropout_7 (Dropout)          (None, 64)                0         
_________________________________________________________________
dense_7 (Dense)              (None, 128)               8192      
_________________________________________________________________
batch_normalization_9 (Batch (None, 128)               512       
_________________________________________________________________
dropout_8 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_8 (Dense)              (None, 256)               32768     
_________________________________________________________________
batch_normalization_10 (Batc (None, 256)               1024      
_________________________________________________________________
dropout_9 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 48240)             12349440  
=================================================================
Total params: 18,867,360
Trainable params: 18,865,360
Non-trainable params: 2,000
_________________________________________________________________
Saved model to disk

Training epoch: 1

/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/common/../Data/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_12_outof_29.npz 

Datagen on the following frames [65, 4, 15, 22, 43, 31, 57, 54, 56, 60, 18, 96, 76, 34, 61]
48/48 [==============================] - 22s 466ms/step - loss: 1.8082 - mean_squared_error: 0.0318 - mean_absolute_error: 0.0655
48/48 [==============================] - 20s 416ms/step - loss: 0.0468 - mean_squared_error: 0.0274 - mean_absolute_error: 0.0386
48/48 [==============================] - 20s 416ms/step - loss: 0.0248 - mean_squared_error: 0.0201 - mean_absolute_error: 0.0348
48/48 [==============================] - 20s 413ms/step - loss: 0.0218 - mean_squared_error: 0.0155 - mean_absolute_error: 0.0345
48/48 [==============================] - 20s 415ms/step - loss: 0.0221 - mean_squared_error: 0.0146 - mean_absolute_error: 0.0395
48/48 [==============================] - 20s 409ms/step - loss: 0.0260 - mean_squared_error: 0.0164 - mean_absolute_error: 0.0651
48/48 [==============================] - 20s 410ms/step - loss: 0.0282 - mean_squared_error: 0.0174 - mean_absolute_error: 0.0788
48/48 [==============================] - 20s 412ms/step - loss: 0.0282 - mean_squared_error: 0.0174 - mean_absolute_error: 0.0804
48/48 [==============================] - 20s 411ms/step - loss: 0.0287 - mean_squared_error: 0.0177 - mean_absolute_error: 0.0812
48/48 [==============================] - 20s 410ms/step - loss: 0.0290 - mean_squared_error: 0.0178 - mean_absolute_error: 0.0819
48/48 [==============================] - 20s 409ms/step - loss: 0.0294 - mean_squared_error: 0.0182 - mean_absolute_error: 0.0808
48/48 [==============================] - 20s 410ms/step - loss: 0.0296 - mean_squared_error: 0.0182 - mean_absolute_error: 0.0835
48/48 [==============================] - 20s 409ms/step - loss: 0.0298 - mean_squared_error: 0.0183 - mean_absolute_error: 0.0797
48/48 [==============================] - 20s 410ms/step - loss: 0.0306 - mean_squared_error: 0.0188 - mean_absolute_error: 0.0856
48/48 [==============================] - 20s 409ms/step - loss: 0.0299 - mean_squared_error: 0.0184 - mean_absolute_error: 0.0814
/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/common/../Data/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_28_outof_29.npz 

Datagen on the following frames [21, 40, 11, 12, 43, 54, 55, 61, 83, 59, 56, 8, 20, 90, 98]
Killed
weismanal@cn4186:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ exit
exit
srun: error: cn4186: task 0: Exited with exit code 137
salloc.exe: Relinquishing job allocation 11959219
salloc.exe: Job allocation 11959219 has been revoked.
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ sinteractive --gres=gpu:k80:1 --mem=100G
salloc.exe: Pending job allocation 11960399
salloc.exe: job 11960399 queued and waiting for resources
salloc.exe: job 11960399 has been allocated resources
salloc.exe: Granted job allocation 11960399
salloc.exe: Waiting for resource configuration
salloc.exe: Nodes cn4186 are ready for job
[weismanal@cn4186 Benchmarks]$ . ~/.bash_profile
weismanal@cn4186:~/repos-local/ECP-CANDLE/Benchmarks $ cd ~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1
weismanal@cn4186:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ git status
# On branch cap-txfr
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#	..log
#	encoder.json
#	epoch_1/
#	model.json
nothing added to commit but untracked files present (use "git add" to track)
weismanal@cn4186:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ rm -rf ..log encoder.json model.json epoch_1
weismanal@cn4186:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ git status
# On branch cap-txfr
nothing to commit, working directory clean
weismanal@cn4186:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ module load python
[+] Loading python 3.7  ... 
weismanal@cn4186:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ python p2b1_baseline_keras2.py
Importing candle utils for keras
Params:
{'activation': 'relu',
 'backend': 'tensorflow',
 'base_memo': 'p2b1',
 'batch_size': 64,
 'case': 'Full',
 'conv_bool': True,
 'cool': False,
 'data_set': '3k_Ordered',
 'data_type': <class 'numpy.float32'>,
 'dropout': 0.5,
 'epochs': 2,
 'eval_bool': False,
 'experiment_id': 'EXP000',
 'fig_bool': False,
 'full_conv_bool': False,
 'home_dir': '.',
 'l2_reg': 0.01,
 'learning_rate': 0.01,
 'logfile': None,
 'loss': 'custom',
 'molecular_nbrs': 200,
 'molecular_nonlinearity': 'elu',
 'molecular_num_hidden': [256, 128, 64, 32, 16, 8],
 'nbr_type': 'relative',
 'noise_factor': 0.0,
 'num_hidden': [512, 32],
 'optimizer': 'adam',
 'output_dir': '/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/Pilot2/P2B1/Output/EXP000/RUN000',
 'profiling': False,
 'rng_seed': 7102,
 'run_id': 'RUN000',
 'sampling_density': 0.15,
 'save_path': '.',
 'set_sel': '3k_Disordered',
 'shuffle': False,
 'timeout': -1,
 'train_bool': True,
 'type_bool': True,
 'verbose': None,
 'weight_path': None}

Training parameters:
	activation: relu
	backend: tensorflow
	base_memo: p2b1
	batch_size: 64
	case: Full
	conv_bool: True
	cool: False
	data_set: 3k_Ordered
	data_type: <class 'numpy.float32'>
	dropout: 0.5
	epochs: 2
	eval_bool: False
	experiment_id: EXP000
	fig_bool: False
	full_conv_bool: False
	home_dir: .
	l2_reg: 0.01
	learning_rate: 0.01
	logfile: None
	loss: custom
	molecular_nbrs: 200
	molecular_nonlinearity: elu
	molecular_num_hidden: [256, 128, 64, 32, 16, 8]
	nbr_type: relative
	noise_factor: 0.0
	num_hidden: [512, 32]
	optimizer: adam
	output_dir: /gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/Pilot2/P2B1/Output/EXP000/RUN000
	profiling: False
	rng_seed: 7102
	run_id: RUN000
	sampling_density: 0.15
	save_path: .
	set_sel: 3k_Disordered
	shuffle: False
	timeout: -1
	train_bool: True
	type_bool: True
	verbose: None
	weight_path: None
Image data format:  channels_last
Params: {'num_hidden': [512, 32], 'batch_size': 64, 'learning_rate': 0.01, 'epochs': 2, 'cool': False, 'l2_reg': 0.01, 'noise_factor': 0.0, 'optimizer': 'adam', 'loss': 'custom', 'activation': 'relu', 'molecular_nonlinearity': 'elu', 'molecular_num_hidden': [256, 128, 64, 32, 16, 8], 'molecular_nbrs': 200, 'base_memo': 'p2b1', 'dropout': 0.5, 'data_set': '3k_Ordered', 'sampling_density': 0.15, 'save_path': '.', 'backend': 'tensorflow', 'verbose': None, 'logfile': None, 'experiment_id': 'EXP000', 'run_id': 'RUN000', 'shuffle': False, 'profiling': False, 'train_bool': True, 'eval_bool': False, 'home_dir': '.', 'weight_path': None, 'case': 'Full', 'fig_bool': False, 'set_sel': '3k_Disordered', 'conv_bool': True, 'full_conv_bool': False, 'type_bool': True, 'nbr_type': 'relative', 'data_type': <class 'numpy.float32'>, 'output_dir': '/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/Pilot2/P2B1/Output/EXP000/RUN000', 'rng_seed': 7102, 'timeout': -1}
Reading Data...
Reading Data Files... 3k_Disordered->3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir

Data chunk shape:  (100, 3040, 12, 20)

State AE input/output dimension:  24320

Molecular AE input/output dimension:  48240

Data Format:
[Frames (2900), Molecules (3040), Beads (12), ['rel_x', 'rel_y', 'rel_z', 'CHOL', 'DPPC', 'DIPC', 'Head', 'Tail', 'BL1', 'BL2', 'BL3', 'BL4', 'BL5', 'BL6', 'BL7', 'BL8', 'BL9', 'BL10', 'BL11', 'BL12'] (20)]

Define the model and compile

Model Summary: 

Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 1, 48240, 1)]     0         
_________________________________________________________________
conv2d (Conv2D)              (None, 1, 2412, 256)      102400    
_________________________________________________________________
batch_normalization (BatchNo (None, 1, 2412, 256)      1024      
_________________________________________________________________
dropout (Dropout)            (None, 1, 2412, 256)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 1, 201, 128)       4718592   
_________________________________________________________________
batch_normalization_1 (Batch (None, 1, 201, 128)       512       
_________________________________________________________________
dropout_1 (Dropout)          (None, 1, 201, 128)       0         
_________________________________________________________________
flatten (Flatten)            (None, 25728)             0         
_________________________________________________________________
dense (Dense)                (None, 64)                1646592   
_________________________________________________________________
batch_normalization_2 (Batch (None, 64)                256       
_________________________________________________________________
dropout_2 (Dropout)          (None, 64)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 32)                2048      
_________________________________________________________________
batch_normalization_3 (Batch (None, 32)                128       
_________________________________________________________________
dropout_3 (Dropout)          (None, 32)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 16)                512       
_________________________________________________________________
batch_normalization_4 (Batch (None, 16)                64        
_________________________________________________________________
dropout_4 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_3 (Dense)              (None, 8)                 128       
_________________________________________________________________
batch_normalization_5 (Batch (None, 8)                 32        
_________________________________________________________________
dense_4 (Dense)              (None, 16)                128       
_________________________________________________________________
batch_normalization_6 (Batch (None, 16)                64        
_________________________________________________________________
dropout_5 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_5 (Dense)              (None, 32)                512       
_________________________________________________________________
batch_normalization_7 (Batch (None, 32)                128       
_________________________________________________________________
dropout_6 (Dropout)          (None, 32)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 64)                2048      
_________________________________________________________________
batch_normalization_8 (Batch (None, 64)                256       
_________________________________________________________________
dropout_7 (Dropout)          (None, 64)                0         
_________________________________________________________________
dense_7 (Dense)              (None, 128)               8192      
_________________________________________________________________
batch_normalization_9 (Batch (None, 128)               512       
_________________________________________________________________
dropout_8 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_8 (Dense)              (None, 256)               32768     
_________________________________________________________________
batch_normalization_10 (Batc (None, 256)               1024      
_________________________________________________________________
dropout_9 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 48240)             12349440  
=================================================================
Total params: 18,867,360
Trainable params: 18,865,360
Non-trainable params: 2,000
_________________________________________________________________
Saved model to disk

Training epoch: 1

/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/common/../Data/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_07_outof_29.npz 

Datagen on the following frames [40, 63, 31, 7, 92, 5, 1, 48, 61, 17, 79, 6, 75, 90, 99]
48/48 [==============================] - 22s 452ms/step - loss: 1.8011 - mean_squared_error: 0.0319 - mean_absolute_error: 0.0654
48/48 [==============================] - 19s 401ms/step - loss: 0.0457 - mean_squared_error: 0.0274 - mean_absolute_error: 0.0386
48/48 [==============================] - 19s 403ms/step - loss: 0.0247 - mean_squared_error: 0.0200 - mean_absolute_error: 0.0348
48/48 [==============================] - 19s 405ms/step - loss: 0.0217 - mean_squared_error: 0.0154 - mean_absolute_error: 0.0344
48/48 [==============================] - 19s 406ms/step - loss: 0.0219 - mean_squared_error: 0.0145 - mean_absolute_error: 0.0396
48/48 [==============================] - 19s 400ms/step - loss: 0.0265 - mean_squared_error: 0.0166 - mean_absolute_error: 0.0666
48/48 [==============================] - 19s 399ms/step - loss: 0.0282 - mean_squared_error: 0.0174 - mean_absolute_error: 0.0775
48/48 [==============================] - 19s 401ms/step - loss: 0.0282 - mean_squared_error: 0.0174 - mean_absolute_error: 0.0790
48/48 [==============================] - 19s 401ms/step - loss: 0.0289 - mean_squared_error: 0.0179 - mean_absolute_error: 0.0839
48/48 [==============================] - 19s 401ms/step - loss: 0.0289 - mean_squared_error: 0.0178 - mean_absolute_error: 0.0828
48/48 [==============================] - 19s 401ms/step - loss: 0.0290 - mean_squared_error: 0.0179 - mean_absolute_error: 0.0810
48/48 [==============================] - 19s 402ms/step - loss: 0.0296 - mean_squared_error: 0.0182 - mean_absolute_error: 0.0824
48/48 [==============================] - 19s 402ms/step - loss: 0.0303 - mean_squared_error: 0.0186 - mean_absolute_error: 0.0860
48/48 [==============================] - 19s 402ms/step - loss: 0.0302 - mean_squared_error: 0.0185 - mean_absolute_error: 0.0814
48/48 [==============================] - 19s 402ms/step - loss: 0.0299 - mean_squared_error: 0.0184 - mean_absolute_error: 0.0817
/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/common/../Data/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_26_outof_29.npz 

Datagen on the following frames [14, 48, 33, 29, 86, 95, 32, 7, 31, 46, 13, 96, 92, 97, 54]
48/48 [==============================] - 19s 396ms/step - loss: 0.0307 - mean_squared_error: 0.0188 - mean_absolute_error: 0.0850
48/48 [==============================] - 19s 397ms/step - loss: 0.0309 - mean_squared_error: 0.0189 - mean_absolute_error: 0.0830
48/48 [==============================] - 19s 398ms/step - loss: 0.0306 - mean_squared_error: 0.0188 - mean_absolute_error: 0.0806
48/48 [==============================] - 19s 398ms/step - loss: 0.0308 - mean_squared_error: 0.0190 - mean_absolute_error: 0.0836
48/48 [==============================] - 19s 400ms/step - loss: 0.0307 - mean_squared_error: 0.0189 - mean_absolute_error: 0.0819
48/48 [==============================] - 19s 401ms/step - loss: 0.0309 - mean_squared_error: 0.0190 - mean_absolute_error: 0.0822
48/48 [==============================] - 19s 401ms/step - loss: 0.0307 - mean_squared_error: 0.0189 - mean_absolute_error: 0.0808
48/48 [==============================] - 19s 402ms/step - loss: 0.0316 - mean_squared_error: 0.0194 - mean_absolute_error: 0.0826
48/48 [==============================] - 19s 402ms/step - loss: 0.0302 - mean_squared_error: 0.0187 - mean_absolute_error: 0.0793
48/48 [==============================] - 19s 403ms/step - loss: 0.0312 - mean_squared_error: 0.0192 - mean_absolute_error: 0.0828
48/48 [==============================] - 19s 404ms/step - loss: 0.0297 - mean_squared_error: 0.0183 - mean_absolute_error: 0.0777
48/48 [==============================] - 19s 405ms/step - loss: 0.0312 - mean_squared_error: 0.0190 - mean_absolute_error: 0.0811
48/48 [==============================] - 19s 403ms/step - loss: 0.0362 - mean_squared_error: 0.0186 - mean_absolute_error: 0.0804
48/48 [==============================] - 19s 404ms/step - loss: 0.0393 - mean_squared_error: 0.0183 - mean_absolute_error: 0.0785
48/48 [==============================] - 19s 405ms/step - loss: 0.0367 - mean_squared_error: 0.0185 - mean_absolute_error: 0.0810
/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/common/../Data/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_28_outof_29.npz 

Datagen on the following frames [20, 39, 14, 6, 47, 82, 44, 41, 99, 78, 13, 95, 25, 94, 5]
48/48 [==============================] - 19s 397ms/step - loss: 0.0354 - mean_squared_error: 0.0182 - mean_absolute_error: 0.0802
48/48 [==============================] - 19s 397ms/step - loss: 0.0352 - mean_squared_error: 0.0179 - mean_absolute_error: 0.0781
48/48 [==============================] - 19s 400ms/step - loss: 0.0353 - mean_squared_error: 0.0180 - mean_absolute_error: 0.0802
48/48 [==============================] - 19s 401ms/step - loss: 0.0348 - mean_squared_error: 0.0179 - mean_absolute_error: 0.0789
48/48 [==============================] - 19s 401ms/step - loss: 0.0358 - mean_squared_error: 0.0180 - mean_absolute_error: 0.0791
48/48 [==============================] - 19s 402ms/step - loss: 0.0344 - mean_squared_error: 0.0173 - mean_absolute_error: 0.0754
48/48 [==============================] - 19s 402ms/step - loss: 0.0341 - mean_squared_error: 0.0176 - mean_absolute_error: 0.0760
48/48 [==============================] - 19s 403ms/step - loss: 0.0348 - mean_squared_error: 0.0172 - mean_absolute_error: 0.0724
48/48 [==============================] - 19s 404ms/step - loss: 0.0352 - mean_squared_error: 0.0176 - mean_absolute_error: 0.0793
48/48 [==============================] - 19s 404ms/step - loss: 0.0326 - mean_squared_error: 0.0165 - mean_absolute_error: 0.0679
48/48 [==============================] - 19s 404ms/step - loss: 0.0369 - mean_squared_error: 0.0180 - mean_absolute_error: 0.0814
48/48 [==============================] - 19s 405ms/step - loss: 0.0359 - mean_squared_error: 0.0162 - mean_absolute_error: 0.0668
48/48 [==============================] - 19s 405ms/step - loss: 0.0364 - mean_squared_error: 0.0175 - mean_absolute_error: 0.0784
48/48 [==============================] - 20s 408ms/step - loss: 0.0372 - mean_squared_error: 0.0162 - mean_absolute_error: 0.0687
48/48 [==============================] - 19s 406ms/step - loss: 0.0364 - mean_squared_error: 0.0172 - mean_absolute_error: 0.0752
/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/common/../Data/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_04_outof_29.npz 

Datagen on the following frames [91, 73, 5, 29, 49, 24, 90, 75, 18, 63, 82, 59, 62, 78, 98]
48/48 [==============================] - 19s 397ms/step - loss: 0.0361 - mean_squared_error: 0.0160 - mean_absolute_error: 0.0669
48/48 [==============================] - 19s 398ms/step - loss: 0.0308 - mean_squared_error: 0.0163 - mean_absolute_error: 0.0707
48/48 [==============================] - 19s 403ms/step - loss: 0.0431 - mean_squared_error: 0.0168 - mean_absolute_error: 0.0758
48/48 [==============================] - 20s 406ms/step - loss: 0.0373 - mean_squared_error: 0.0163 - mean_absolute_error: 0.0724
48/48 [==============================] - 19s 406ms/step - loss: 0.0331 - mean_squared_error: 0.0164 - mean_absolute_error: 0.0736
48/48 [==============================] - 19s 405ms/step - loss: 0.0338 - mean_squared_error: 0.0161 - mean_absolute_error: 0.0692
48/48 [==============================] - 19s 404ms/step - loss: 0.0375 - mean_squared_error: 0.0162 - mean_absolute_error: 0.0727
48/48 [==============================] - 20s 410ms/step - loss: 0.0366 - mean_squared_error: 0.0159 - mean_absolute_error: 0.0697
48/48 [==============================] - 20s 410ms/step - loss: 0.0328 - mean_squared_error: 0.0158 - mean_absolute_error: 0.0684
48/48 [==============================] - 20s 411ms/step - loss: 0.0402 - mean_squared_error: 0.0165 - mean_absolute_error: 0.0744
48/48 [==============================] - 20s 410ms/step - loss: 0.0340 - mean_squared_error: 0.0155 - mean_absolute_error: 0.0662
48/48 [==============================] - 20s 409ms/step - loss: 0.0349 - mean_squared_error: 0.0164 - mean_absolute_error: 0.0731
48/48 [==============================] - 19s 406ms/step - loss: 0.0328 - mean_squared_error: 0.0152 - mean_absolute_error: 0.0648
48/48 [==============================] - 19s 406ms/step - loss: 0.0328 - mean_squared_error: 0.0161 - mean_absolute_error: 0.0706
48/48 [==============================] - 19s 406ms/step - loss: 0.0346 - mean_squared_error: 0.0160 - mean_absolute_error: 0.0697
Saving loss and mse after current epoch... 

Saving weights after current epoch... 

Saving latent space output for current epoch... 

Datagen on the following frames [0, 30, 52, 29, 65, 69, 10, 22, 17, 62, 13, 57, 76, 87, 36]
Killed
weismanal@cn4186:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ gpus

                                                    .......Per-Node Resources......
Partition      FreeNds      FreeCPUs      FreeGPUs  Cores  CPUs  GPUs    Mem   Disk Features                                        
-------------------------------------------------------------------------------------------------------
gpu (v100x)     0 / 54     2254 / 3888    55 / 216     36    72     4   373g  1600g cpu72,core36,g384,ssd1600,x6140,ibhdr,gpuv100x  
gpu (p100)      0 / 47     1668 / 2632    66 / 188     28    56     4   121g   650g cpu56,core28,g128,ssd650,x2680,ibfdr,gpup100    
gpu (k80)       5 / 23      740 / 1288    27 / 92      28    56     4   247g   400g cpu56,core28,g256,ssd400,x2695,ibfdr,gpuk80     
gpu (k80)       0 / 67     1650 / 3752     7 / 268     28    56     4   247g   800g cpu56,core28,g256,ssd800,x2680,ibfdr,gpuk80     
gpu (v100)      0 / 5       160 / 280      2 / 20      28    56     4   121g   800g cpu56,core28,g128,ssd800,x2680,ibfdr,gpuv100    
gpu (k20x)     13 / 16      416 / 512     26 / 32      16    32     2   121g   800g cpu32,core16,g128,ssd800,x2650,10g,gpuk20x      
weismanal@cn4186:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ exit
exit
salloc.exe: Relinquishing job allocation 11960399
salloc.exe: Job allocation 11960399 has been revoked.
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ 
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ 
weismanal@biowulf:~/repos-local/ECP-CANDLE/Benchmarks $ sinteractive --gres=gpu:v100x:1 --mem=150G
salloc.exe: Pending job allocation 11966745
salloc.exe: job 11966745 queued and waiting for resources
salloc.exe: job 11966745 has been allocated resources
salloc.exe: Granted job allocation 11966745
salloc.exe: Waiting for resource configuration
salloc.exe: Nodes cn0797 are ready for job
[weismanal@cn0797 Benchmarks]$ . ~/.bash_profile
weismanal@cn0797:~/repos-local/ECP-CANDLE/Benchmarks $ cd ~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1
weismanal@cn0797:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ git status
# On branch cap-txfr
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#	..log
#	encoder.json
#	epoch_1/
#	model.json
nothing added to commit but untracked files present (use "git add" to track)
weismanal@cn0797:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ rm -rf ..log encoder.json model.json epoch_1
weismanal@cn0797:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ git status
# On branch cap-txfr
nothing to commit, working directory clean
weismanal@cn0797:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ module load python
[+] Loading python 3.7  ... 
weismanal@cn0797:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ python p2b1_baseline_keras2.py
Importing candle utils for keras
Params:
{'activation': 'relu',
 'backend': 'tensorflow',
 'base_memo': 'p2b1',
 'batch_size': 64,
 'case': 'Full',
 'conv_bool': True,
 'cool': False,
 'data_set': '3k_Ordered',
 'data_type': <class 'numpy.float32'>,
 'dropout': 0.5,
 'epochs': 2,
 'eval_bool': False,
 'experiment_id': 'EXP000',
 'fig_bool': False,
 'full_conv_bool': False,
 'home_dir': '.',
 'l2_reg': 0.01,
 'learning_rate': 0.01,
 'logfile': None,
 'loss': 'custom',
 'molecular_nbrs': 200,
 'molecular_nonlinearity': 'elu',
 'molecular_num_hidden': [256, 128, 64, 32, 16, 8],
 'nbr_type': 'relative',
 'noise_factor': 0.0,
 'num_hidden': [512, 32],
 'optimizer': 'adam',
 'output_dir': '/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/Pilot2/P2B1/Output/EXP000/RUN000',
 'profiling': False,
 'rng_seed': 7102,
 'run_id': 'RUN000',
 'sampling_density': 0.15,
 'save_path': '.',
 'set_sel': '3k_Disordered',
 'shuffle': False,
 'timeout': -1,
 'train_bool': True,
 'type_bool': True,
 'verbose': None,
 'weight_path': None}

Training parameters:
	activation: relu
	backend: tensorflow
	base_memo: p2b1
	batch_size: 64
	case: Full
	conv_bool: True
	cool: False
	data_set: 3k_Ordered
	data_type: <class 'numpy.float32'>
	dropout: 0.5
	epochs: 2
	eval_bool: False
	experiment_id: EXP000
	fig_bool: False
	full_conv_bool: False
	home_dir: .
	l2_reg: 0.01
	learning_rate: 0.01
	logfile: None
	loss: custom
	molecular_nbrs: 200
	molecular_nonlinearity: elu
	molecular_num_hidden: [256, 128, 64, 32, 16, 8]
	nbr_type: relative
	noise_factor: 0.0
	num_hidden: [512, 32]
	optimizer: adam
	output_dir: /gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/Pilot2/P2B1/Output/EXP000/RUN000
	profiling: False
	rng_seed: 7102
	run_id: RUN000
	sampling_density: 0.15
	save_path: .
	set_sel: 3k_Disordered
	shuffle: False
	timeout: -1
	train_bool: True
	type_bool: True
	verbose: None
	weight_path: None
Image data format:  channels_last
Params: {'num_hidden': [512, 32], 'batch_size': 64, 'learning_rate': 0.01, 'epochs': 2, 'cool': False, 'l2_reg': 0.01, 'noise_factor': 0.0, 'optimizer': 'adam', 'loss': 'custom', 'activation': 'relu', 'molecular_nonlinearity': 'elu', 'molecular_num_hidden': [256, 128, 64, 32, 16, 8], 'molecular_nbrs': 200, 'base_memo': 'p2b1', 'dropout': 0.5, 'data_set': '3k_Ordered', 'sampling_density': 0.15, 'save_path': '.', 'backend': 'tensorflow', 'verbose': None, 'logfile': None, 'experiment_id': 'EXP000', 'run_id': 'RUN000', 'shuffle': False, 'profiling': False, 'train_bool': True, 'eval_bool': False, 'home_dir': '.', 'weight_path': None, 'case': 'Full', 'fig_bool': False, 'set_sel': '3k_Disordered', 'conv_bool': True, 'full_conv_bool': False, 'type_bool': True, 'nbr_type': 'relative', 'data_type': <class 'numpy.float32'>, 'output_dir': '/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/Pilot2/P2B1/Output/EXP000/RUN000', 'rng_seed': 7102, 'timeout': -1}
Reading Data...
Reading Data Files... 3k_Disordered->3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir

Data chunk shape:  (100, 3040, 12, 20)

State AE input/output dimension:  24320

Molecular AE input/output dimension:  48240

Data Format:
[Frames (2900), Molecules (3040), Beads (12), ['rel_x', 'rel_y', 'rel_z', 'CHOL', 'DPPC', 'DIPC', 'Head', 'Tail', 'BL1', 'BL2', 'BL3', 'BL4', 'BL5', 'BL6', 'BL7', 'BL8', 'BL9', 'BL10', 'BL11', 'BL12'] (20)]

Define the model and compile

Model Summary: 

Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 1, 48240, 1)]     0         
_________________________________________________________________
conv2d (Conv2D)              (None, 1, 2412, 256)      102400    
_________________________________________________________________
batch_normalization (BatchNo (None, 1, 2412, 256)      1024      
_________________________________________________________________
dropout (Dropout)            (None, 1, 2412, 256)      0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 1, 201, 128)       4718592   
_________________________________________________________________
batch_normalization_1 (Batch (None, 1, 201, 128)       512       
_________________________________________________________________
dropout_1 (Dropout)          (None, 1, 201, 128)       0         
_________________________________________________________________
flatten (Flatten)            (None, 25728)             0         
_________________________________________________________________
dense (Dense)                (None, 64)                1646592   
_________________________________________________________________
batch_normalization_2 (Batch (None, 64)                256       
_________________________________________________________________
dropout_2 (Dropout)          (None, 64)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 32)                2048      
_________________________________________________________________
batch_normalization_3 (Batch (None, 32)                128       
_________________________________________________________________
dropout_3 (Dropout)          (None, 32)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 16)                512       
_________________________________________________________________
batch_normalization_4 (Batch (None, 16)                64        
_________________________________________________________________
dropout_4 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_3 (Dense)              (None, 8)                 128       
_________________________________________________________________
batch_normalization_5 (Batch (None, 8)                 32        
_________________________________________________________________
dense_4 (Dense)              (None, 16)                128       
_________________________________________________________________
batch_normalization_6 (Batch (None, 16)                64        
_________________________________________________________________
dropout_5 (Dropout)          (None, 16)                0         
_________________________________________________________________
dense_5 (Dense)              (None, 32)                512       
_________________________________________________________________
batch_normalization_7 (Batch (None, 32)                128       
_________________________________________________________________
dropout_6 (Dropout)          (None, 32)                0         
_________________________________________________________________
dense_6 (Dense)              (None, 64)                2048      
_________________________________________________________________
batch_normalization_8 (Batch (None, 64)                256       
_________________________________________________________________
dropout_7 (Dropout)          (None, 64)                0         
_________________________________________________________________
dense_7 (Dense)              (None, 128)               8192      
_________________________________________________________________
batch_normalization_9 (Batch (None, 128)               512       
_________________________________________________________________
dropout_8 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_8 (Dense)              (None, 256)               32768     
_________________________________________________________________
batch_normalization_10 (Batc (None, 256)               1024      
_________________________________________________________________
dropout_9 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_9 (Dense)              (None, 48240)             12349440  
=================================================================
Total params: 18,867,360
Trainable params: 18,865,360
Non-trainable params: 2,000
_________________________________________________________________
Saved model to disk

Training epoch: 1

/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/common/../Data/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_05_outof_29.npz 

Datagen on the following frames [82, 72, 1, 24, 65, 73, 30, 18, 70, 16, 53, 29, 21, 35, 78]
48/48 [==============================] - 82s 2s/step - loss: 1.8080 - mean_squared_error: 0.0319 - mean_absolute_error: 0.0655
48/48 [==============================] - 3s 66ms/step - loss: 0.0454 - mean_squared_error: 0.0274 - mean_absolute_error: 0.0386
48/48 [==============================] - 3s 67ms/step - loss: 0.0247 - mean_squared_error: 0.0201 - mean_absolute_error: 0.0348
48/48 [==============================] - 3s 62ms/step - loss: 0.0218 - mean_squared_error: 0.0155 - mean_absolute_error: 0.0345
48/48 [==============================] - 3s 63ms/step - loss: 0.0219 - mean_squared_error: 0.0145 - mean_absolute_error: 0.0392
48/48 [==============================] - 3s 62ms/step - loss: 0.0263 - mean_squared_error: 0.0166 - mean_absolute_error: 0.0658
48/48 [==============================] - 3s 63ms/step - loss: 0.0281 - mean_squared_error: 0.0174 - mean_absolute_error: 0.0763
48/48 [==============================] - 3s 62ms/step - loss: 0.0283 - mean_squared_error: 0.0175 - mean_absolute_error: 0.0801
48/48 [==============================] - 3s 63ms/step - loss: 0.0282 - mean_squared_error: 0.0175 - mean_absolute_error: 0.0807
48/48 [==============================] - 3s 63ms/step - loss: 0.0290 - mean_squared_error: 0.0179 - mean_absolute_error: 0.0829
48/48 [==============================] - 3s 63ms/step - loss: 0.0290 - mean_squared_error: 0.0179 - mean_absolute_error: 0.0800
48/48 [==============================] - 3s 62ms/step - loss: 0.0301 - mean_squared_error: 0.0185 - mean_absolute_error: 0.0851
48/48 [==============================] - 3s 62ms/step - loss: 0.0300 - mean_squared_error: 0.0185 - mean_absolute_error: 0.0838
48/48 [==============================] - 3s 62ms/step - loss: 0.0297 - mean_squared_error: 0.0182 - mean_absolute_error: 0.0809
48/48 [==============================] - 3s 62ms/step - loss: 0.0305 - mean_squared_error: 0.0187 - mean_absolute_error: 0.0851
/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/common/../Data/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_24_outof_29.npz 

Datagen on the following frames [13, 79, 60, 20, 84, 69, 76, 59, 18, 49, 67, 91, 29, 21, 31]
48/48 [==============================] - 3s 64ms/step - loss: 0.0302 - mean_squared_error: 0.0187 - mean_absolute_error: 0.0841
48/48 [==============================] - 3s 62ms/step - loss: 0.0310 - mean_squared_error: 0.0189 - mean_absolute_error: 0.0849
48/48 [==============================] - 3s 63ms/step - loss: 0.0305 - mean_squared_error: 0.0188 - mean_absolute_error: 0.0839
48/48 [==============================] - 3s 62ms/step - loss: 0.0314 - mean_squared_error: 0.0193 - mean_absolute_error: 0.0842
48/48 [==============================] - 3s 62ms/step - loss: 0.0305 - mean_squared_error: 0.0188 - mean_absolute_error: 0.0835
48/48 [==============================] - 3s 63ms/step - loss: 0.0309 - mean_squared_error: 0.0190 - mean_absolute_error: 0.0843
48/48 [==============================] - 3s 62ms/step - loss: 0.0310 - mean_squared_error: 0.0190 - mean_absolute_error: 0.0817
48/48 [==============================] - 3s 63ms/step - loss: 0.0309 - mean_squared_error: 0.0189 - mean_absolute_error: 0.0839
48/48 [==============================] - 3s 63ms/step - loss: 0.0318 - mean_squared_error: 0.0194 - mean_absolute_error: 0.0830
48/48 [==============================] - 3s 62ms/step - loss: 0.0310 - mean_squared_error: 0.0190 - mean_absolute_error: 0.0827
48/48 [==============================] - 3s 65ms/step - loss: 0.0307 - mean_squared_error: 0.0187 - mean_absolute_error: 0.0810
48/48 [==============================] - 3s 63ms/step - loss: 0.0313 - mean_squared_error: 0.0189 - mean_absolute_error: 0.0804
48/48 [==============================] - 3s 64ms/step - loss: 0.0360 - mean_squared_error: 0.0185 - mean_absolute_error: 0.0805
48/48 [==============================] - 3s 62ms/step - loss: 0.0402 - mean_squared_error: 0.0187 - mean_absolute_error: 0.0818
48/48 [==============================] - 3s 62ms/step - loss: 0.0370 - mean_squared_error: 0.0184 - mean_absolute_error: 0.0796
/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/common/../Data/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_15_outof_29.npz 

Datagen on the following frames [63, 94, 0, 83, 36, 57, 78, 23, 95, 90, 76, 42, 33, 81, 12]
48/48 [==============================] - 3s 64ms/step - loss: 0.0363 - mean_squared_error: 0.0184 - mean_absolute_error: 0.0786
48/48 [==============================] - 3s 64ms/step - loss: 0.0355 - mean_squared_error: 0.0181 - mean_absolute_error: 0.0799
48/48 [==============================] - 3s 62ms/step - loss: 0.0346 - mean_squared_error: 0.0178 - mean_absolute_error: 0.0780
48/48 [==============================] - 3s 64ms/step - loss: 0.0355 - mean_squared_error: 0.0180 - mean_absolute_error: 0.0770
48/48 [==============================] - 3s 62ms/step - loss: 0.0351 - mean_squared_error: 0.0177 - mean_absolute_error: 0.0745
48/48 [==============================] - 3s 62ms/step - loss: 0.0354 - mean_squared_error: 0.0182 - mean_absolute_error: 0.0797
48/48 [==============================] - 3s 63ms/step - loss: 0.0329 - mean_squared_error: 0.0169 - mean_absolute_error: 0.0689
48/48 [==============================] - 3s 63ms/step - loss: 0.0371 - mean_squared_error: 0.0179 - mean_absolute_error: 0.0764
48/48 [==============================] - 3s 63ms/step - loss: 0.0334 - mean_squared_error: 0.0171 - mean_absolute_error: 0.0750
48/48 [==============================] - 3s 63ms/step - loss: 0.0345 - mean_squared_error: 0.0169 - mean_absolute_error: 0.0716
48/48 [==============================] - 3s 63ms/step - loss: 0.0339 - mean_squared_error: 0.0172 - mean_absolute_error: 0.0748
48/48 [==============================] - 3s 63ms/step - loss: 0.0338 - mean_squared_error: 0.0168 - mean_absolute_error: 0.0736
48/48 [==============================] - 3s 63ms/step - loss: 0.0345 - mean_squared_error: 0.0168 - mean_absolute_error: 0.0742
48/48 [==============================] - 3s 65ms/step - loss: 0.0316 - mean_squared_error: 0.0166 - mean_absolute_error: 0.0734
48/48 [==============================] - 3s 62ms/step - loss: 0.0312 - mean_squared_error: 0.0164 - mean_absolute_error: 0.0718
/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/common/../Data/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_14_outof_29.npz 

Datagen on the following frames [96, 83, 30, 29, 12, 36, 33, 57, 16, 97, 82, 72, 19, 4, 84]
48/48 [==============================] - 3s 63ms/step - loss: 0.0348 - mean_squared_error: 0.0174 - mean_absolute_error: 0.0782
48/48 [==============================] - 3s 62ms/step - loss: 0.0432 - mean_squared_error: 0.0161 - mean_absolute_error: 0.0700
48/48 [==============================] - 3s 68ms/step - loss: 0.0391 - mean_squared_error: 0.0159 - mean_absolute_error: 0.0680
48/48 [==============================] - 3s 63ms/step - loss: 0.0380 - mean_squared_error: 0.0171 - mean_absolute_error: 0.0793
48/48 [==============================] - 3s 63ms/step - loss: 0.0410 - mean_squared_error: 0.0160 - mean_absolute_error: 0.0683
48/48 [==============================] - 3s 66ms/step - loss: 0.0346 - mean_squared_error: 0.0165 - mean_absolute_error: 0.0734
48/48 [==============================] - 3s 65ms/step - loss: 0.0323 - mean_squared_error: 0.0159 - mean_absolute_error: 0.0661
48/48 [==============================] - 3s 63ms/step - loss: 0.0337 - mean_squared_error: 0.0160 - mean_absolute_error: 0.0718
48/48 [==============================] - 3s 68ms/step - loss: 0.0360 - mean_squared_error: 0.0159 - mean_absolute_error: 0.0707
48/48 [==============================] - 3s 62ms/step - loss: 0.0387 - mean_squared_error: 0.0168 - mean_absolute_error: 0.0730
48/48 [==============================] - 3s 62ms/step - loss: 0.0305 - mean_squared_error: 0.0154 - mean_absolute_error: 0.0661
48/48 [==============================] - 3s 68ms/step - loss: 0.0334 - mean_squared_error: 0.0159 - mean_absolute_error: 0.0696
48/48 [==============================] - 3s 62ms/step - loss: 0.0340 - mean_squared_error: 0.0155 - mean_absolute_error: 0.0671
48/48 [==============================] - 3s 64ms/step - loss: 0.0352 - mean_squared_error: 0.0159 - mean_absolute_error: 0.0701
48/48 [==============================] - 3s 65ms/step - loss: 0.0320 - mean_squared_error: 0.0155 - mean_absolute_error: 0.0659
Saving loss and mse after current epoch... 

Saving weights after current epoch... 

Saving latent space output for current epoch... 

Datagen on the following frames [98, 2, 90, 97, 31, 30, 21, 41, 35, 48, 11, 54, 50, 18, 70]
./epoch_1/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_08_outof_29_AE_IncludeTrue_ConvTrue.npy

Training epoch: 2

/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/common/../Data/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_25_outof_29.npz 

Datagen on the following frames [59, 16, 67, 40, 1, 57, 13, 18, 21, 64, 8, 73, 12, 44, 92]
48/48 [==============================] - 3s 63ms/step - loss: 0.0366 - mean_squared_error: 0.0161 - mean_absolute_error: 0.0715
48/48 [==============================] - 3s 66ms/step - loss: 0.0373 - mean_squared_error: 0.0164 - mean_absolute_error: 0.0727
48/48 [==============================] - 3s 63ms/step - loss: 0.0444 - mean_squared_error: 0.0160 - mean_absolute_error: 0.0674
48/48 [==============================] - 3s 62ms/step - loss: 0.0444 - mean_squared_error: 0.0155 - mean_absolute_error: 0.0657
48/48 [==============================] - 3s 69ms/step - loss: 0.0289 - mean_squared_error: 0.0145 - mean_absolute_error: 0.0573
48/48 [==============================] - 3s 62ms/step - loss: 0.0349 - mean_squared_error: 0.0169 - mean_absolute_error: 0.0775
48/48 [==============================] - 3s 61ms/step - loss: 0.0292 - mean_squared_error: 0.0144 - mean_absolute_error: 0.0549
48/48 [==============================] - 3s 63ms/step - loss: 0.0336 - mean_squared_error: 0.0158 - mean_absolute_error: 0.0685
48/48 [==============================] - 3s 63ms/step - loss: 0.0379 - mean_squared_error: 0.0151 - mean_absolute_error: 0.0633
48/48 [==============================] - 3s 63ms/step - loss: 0.0315 - mean_squared_error: 0.0157 - mean_absolute_error: 0.0691
48/48 [==============================] - 3s 63ms/step - loss: 0.0325 - mean_squared_error: 0.0154 - mean_absolute_error: 0.0671
48/48 [==============================] - 3s 63ms/step - loss: 0.0433 - mean_squared_error: 0.0165 - mean_absolute_error: 0.0719
48/48 [==============================] - 3s 63ms/step - loss: 0.0306 - mean_squared_error: 0.0144 - mean_absolute_error: 0.0557
48/48 [==============================] - 3s 63ms/step - loss: 0.0290 - mean_squared_error: 0.0151 - mean_absolute_error: 0.0644
48/48 [==============================] - 3s 62ms/step - loss: 0.0306 - mean_squared_error: 0.0148 - mean_absolute_error: 0.0609
/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/common/../Data/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_18_outof_29.npz 

Datagen on the following frames [73, 35, 81, 3, 75, 70, 2, 57, 63, 1, 85, 67, 19, 64, 91]
48/48 [==============================] - 3s 69ms/step - loss: 0.0492 - mean_squared_error: 0.0176 - mean_absolute_error: 0.0792
48/48 [==============================] - 3s 62ms/step - loss: 0.0515 - mean_squared_error: 0.0157 - mean_absolute_error: 0.0633
48/48 [==============================] - 3s 63ms/step - loss: 0.0290 - mean_squared_error: 0.0140 - mean_absolute_error: 0.0532
48/48 [==============================] - 3s 68ms/step - loss: 0.0277 - mean_squared_error: 0.0143 - mean_absolute_error: 0.0571
48/48 [==============================] - 3s 65ms/step - loss: 0.0311 - mean_squared_error: 0.0154 - mean_absolute_error: 0.0671
48/48 [==============================] - 3s 62ms/step - loss: 0.0315 - mean_squared_error: 0.0150 - mean_absolute_error: 0.0641
48/48 [==============================] - 3s 68ms/step - loss: 0.0303 - mean_squared_error: 0.0149 - mean_absolute_error: 0.0625
48/48 [==============================] - 3s 62ms/step - loss: 0.0337 - mean_squared_error: 0.0151 - mean_absolute_error: 0.0644
48/48 [==============================] - 3s 62ms/step - loss: 0.0363 - mean_squared_error: 0.0151 - mean_absolute_error: 0.0656
48/48 [==============================] - 3s 65ms/step - loss: 0.0335 - mean_squared_error: 0.0159 - mean_absolute_error: 0.0712
48/48 [==============================] - 3s 63ms/step - loss: 0.0331 - mean_squared_error: 0.0150 - mean_absolute_error: 0.0626
48/48 [==============================] - 3s 62ms/step - loss: 0.0323 - mean_squared_error: 0.0144 - mean_absolute_error: 0.0605
48/48 [==============================] - 3s 69ms/step - loss: 0.0371 - mean_squared_error: 0.0154 - mean_absolute_error: 0.0689
48/48 [==============================] - 3s 64ms/step - loss: 0.0347 - mean_squared_error: 0.0148 - mean_absolute_error: 0.0617
48/48 [==============================] - 3s 63ms/step - loss: 0.0363 - mean_squared_error: 0.0161 - mean_absolute_error: 0.0718
/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/common/../Data/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_29_outof_29.npz 

Datagen on the following frames [25, 34, 51, 30, 79, 96, 81, 89, 29, 66, 56, 91, 70, 98, 42]
48/48 [==============================] - 3s 64ms/step - loss: 0.0325 - mean_squared_error: 0.0142 - mean_absolute_error: 0.0555
48/48 [==============================] - 3s 62ms/step - loss: 0.0335 - mean_squared_error: 0.0148 - mean_absolute_error: 0.0622
48/48 [==============================] - 3s 62ms/step - loss: 0.0723 - mean_squared_error: 0.0195 - mean_absolute_error: 0.0900
48/48 [==============================] - 3s 62ms/step - loss: 0.0354 - mean_squared_error: 0.0141 - mean_absolute_error: 0.0538
48/48 [==============================] - 3s 64ms/step - loss: 0.0084 - mean_squared_error: 0.0020 - mean_absolute_error: 0.0227
48/48 [==============================] - 3s 62ms/step - loss: 0.0056 - mean_squared_error: 3.4140e-04 - mean_absolute_error: 0.0160
48/48 [==============================] - 3s 62ms/step - loss: 0.0068 - mean_squared_error: 3.1314e-04 - mean_absolute_error: 0.0149
48/48 [==============================] - 3s 62ms/step - loss: 0.0084 - mean_squared_error: 2.9036e-04 - mean_absolute_error: 0.0146
48/48 [==============================] - 3s 62ms/step - loss: 0.0310 - mean_squared_error: 0.0143 - mean_absolute_error: 0.0451
48/48 [==============================] - 3s 62ms/step - loss: 0.0141 - mean_squared_error: 0.0018 - mean_absolute_error: 0.0250
48/48 [==============================] - 3s 62ms/step - loss: 0.0340 - mean_squared_error: 0.0143 - mean_absolute_error: 0.0459
48/48 [==============================] - 3s 62ms/step - loss: 0.0183 - mean_squared_error: 0.0022 - mean_absolute_error: 0.0279
48/48 [==============================] - 3s 62ms/step - loss: 0.0150 - mean_squared_error: 5.2248e-04 - mean_absolute_error: 0.0190
48/48 [==============================] - 3s 72ms/step - loss: 0.0136 - mean_squared_error: 3.6744e-04 - mean_absolute_error: 0.0160
48/48 [==============================] - 3s 62ms/step - loss: 0.0337 - mean_squared_error: 0.0146 - mean_absolute_error: 0.0503
/gpfs/gsfs10/users/weismanal/repos/ECP-CANDLE/Benchmarks/common/../Data/Pilot2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20.dir/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_06_outof_29.npz 

Datagen on the following frames [87, 67, 27, 68, 81, 78, 22, 20, 56, 25, 70, 96, 17, 18, 46]
48/48 [==============================] - 3s 64ms/step - loss: 0.0355 - mean_squared_error: 0.0152 - mean_absolute_error: 0.0637
48/48 [==============================] - 3s 64ms/step - loss: 0.0372 - mean_squared_error: 0.0151 - mean_absolute_error: 0.0640
48/48 [==============================] - 3s 65ms/step - loss: 0.0382 - mean_squared_error: 0.0156 - mean_absolute_error: 0.0668
48/48 [==============================] - 3s 62ms/step - loss: 0.0291 - mean_squared_error: 0.0145 - mean_absolute_error: 0.0578
48/48 [==============================] - 3s 63ms/step - loss: 0.0338 - mean_squared_error: 0.0161 - mean_absolute_error: 0.0729
48/48 [==============================] - 3s 62ms/step - loss: 0.0371 - mean_squared_error: 0.0148 - mean_absolute_error: 0.0614
48/48 [==============================] - 3s 62ms/step - loss: 0.0312 - mean_squared_error: 0.0145 - mean_absolute_error: 0.0606
48/48 [==============================] - 3s 62ms/step - loss: 0.0340 - mean_squared_error: 0.0153 - mean_absolute_error: 0.0643
48/48 [==============================] - 3s 64ms/step - loss: 0.0356 - mean_squared_error: 0.0150 - mean_absolute_error: 0.0633
48/48 [==============================] - 3s 63ms/step - loss: 0.0340 - mean_squared_error: 0.0159 - mean_absolute_error: 0.0684
48/48 [==============================] - 3s 63ms/step - loss: 0.0432 - mean_squared_error: 0.0164 - mean_absolute_error: 0.0723
48/48 [==============================] - 3s 63ms/step - loss: 0.0309 - mean_squared_error: 0.0138 - mean_absolute_error: 0.0520
48/48 [==============================] - 3s 63ms/step - loss: 0.0298 - mean_squared_error: 0.0146 - mean_absolute_error: 0.0597
48/48 [==============================] - 3s 62ms/step - loss: 0.0325 - mean_squared_error: 0.0151 - mean_absolute_error: 0.0632
48/48 [==============================] - 3s 62ms/step - loss: 0.0314 - mean_squared_error: 0.0146 - mean_absolute_error: 0.0599
Saving loss and mse after current epoch... 

Saving weights after current epoch... 

Saving latent space output for current epoch... 

Datagen on the following frames [9, 30, 49, 45, 90, 35, 11, 20, 64, 65, 22, 57, 0, 13, 79]
./epoch_2/3k_run10_10us.35fs-DPPC.10-DOPC.70-CHOL.20_chunk_08_outof_29_AE_IncludeTrue_ConvTrue.npy
weismanal@cn0797:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ ls
encoder.json  helper.py   Output		   p2b1_default_model.txt  p2b1_small_model.txt  __pycache__
epoch_1       INSTALL.md  p2b1_AE_models.py	   p2b1_medium_model.txt   parameter_set.R	 README.md
epoch_2       model.json  p2b1_baseline_keras2.py  p2b1.py		   pilot2_datasets.py
weismanal@cn0797:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ git status
# On branch cap-txfr
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#	..log
#	encoder.json
#	epoch_1/
#	epoch_2/
#	model.json
nothing added to commit but untracked files present (use "git add" to track)
weismanal@cn0797:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ ^C
weismanal@cn0797:~/repos-local/ECP-CANDLE/Benchmarks/Pilot2/P2B1 $ 

